{$DOMAIN:localhost} {
    # Reverse proxy to Next.js frontend
    # Next.js handles /api/v1/* rewrites to the Rust backend internally
    reverse_proxy web:3000

    # Security headers
    header {
        X-Content-Type-Options nosniff
        X-Frame-Options DENY
        Referrer-Policy strict-origin-when-cross-origin
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    }

    # Gzip compression
    encode gzip

    # Logging
    log {
        output stdout
    }
}
